/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var t={186(t,e,n){t.exports=n.p+"2429af6d3a5796e3c34b.png"},227(t,e,n){t.exports=n.p+"f5c75398bcb5931f9f3c.png"},540(t){t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},756(t,e,n){t.exports=n.p+"bf0ed0dca1d1e6091d42.png"},1016(t,e,n){n.d(e,{A:()=>qt});var r=n(1601),o=n.n(r),i=n(6314),a=n.n(i),c=n(4417),l=n.n(c),u=new URL(n(7935),n.b),s=new URL(n(1409),n.b),f=new URL(n(3232),n.b),p=new URL(n(1265),n.b),h=new URL(n(6267),n.b),d=new URL(n(186),n.b),y=new URL(n(9745),n.b),b=new URL(n(8490),n.b),m=new URL(n(2573),n.b),v=new URL(n(4496),n.b),g=new URL(n(8956),n.b),w=new URL(n(9221),n.b),S=new URL(n(6092),n.b),k=new URL(n(4184),n.b),P=new URL(n(5513),n.b),x=new URL(n(3062),n.b),O=new URL(n(4875),n.b),j=new URL(n(5134),n.b),L=new URL(n(7335),n.b),E=new URL(n(6153),n.b),T=new URL(n(9e3),n.b),C=new URL(n(9593),n.b),R=new URL(n(5523),n.b),_=new URL(n(7986),n.b),U=new URL(n(4041),n.b),G=new URL(n(7538),n.b),M=new URL(n(1605),n.b),$=new URL(n(6318),n.b),A=new URL(n(3933),n.b),I=new URL(n(6291),n.b),z=new URL(n(9702),n.b),D=new URL(n(1906),n.b),N=new URL(n(4347),n.b),B=new URL(n(1216),n.b),F=new URL(n(4437),n.b),q=new URL(n(3160),n.b),H=new URL(n(8341),n.b),J=new URL(n(2076),n.b),Q=new URL(n(3860),n.b),W=new URL(n(6943),n.b),K=new URL(n(6168),n.b),V=new URL(n(227),n.b),X=new URL(n(756),n.b),Y=new URL(n(9334),n.b),Z=a()(o()),tt=l()(u),et=l()(s),nt=l()(f),rt=l()(p),ot=l()(h),it=l()(d),at=l()(y),ct=l()(b),lt=l()(m),ut=l()(v),st=l()(g),ft=l()(w),pt=l()(S),ht=l()(k),dt=l()(P),yt=l()(x),bt=l()(O),mt=l()(j),vt=l()(L),gt=l()(E),wt=l()(T),St=l()(C),kt=l()(R),Pt=l()(_),xt=l()(U),Ot=l()(G),jt=l()(M),Lt=l()($),Et=l()(A),Tt=l()(I),Ct=l()(z),Rt=l()(D),_t=l()(N),Ut=l()(B),Gt=l()(F),Mt=l()(q),$t=l()(H),At=l()(J),It=l()(Q),zt=l()(W),Dt=l()(K),Nt=l()(V),Bt=l()(X),Ft=l()(Y);Z.push([t.id,`:root {\n  --cell-size: 64px;\n}\n\nhtml, body {\n  height: 100%;\n  margin: 0;\n}\n\nbody {\n  background: #000;\n  font-size: 16px;\n}\n\n.btn {\n  display: inline-block;\n  font-weight: 400;\n  color: #212529;\n  background-color: #f8f9fa;\n  text-align: center;\n  vertical-align: middle;\n  padding: .375rem .75rem;\n  font-size: 1rem;\n  line-height: 1.5;\n  border-radius: .25rem;\n  transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;\n  border: none;\n}\n\n.controls {\n  text-align: center;\n  margin: 50px 0;\n}\n\n.board-container {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-wrap: wrap;\n}\n\n.board {\n  display: grid;\n  grid-template-columns: repeat(8, 1fr);\n  grid-column-gap: 2px;\n  grid-row-gap: 2px;\n}\n\n.cell {\n  position: relative;\n}\n\n.cell.selected::before {\n  content: '';\n  display: block;\n  border: 4px;\n  border-radius: 32px;\n  box-sizing: border-box;\n  width: var(--cell-size);\n  height: var(--cell-size);\n  opacity: 0.9;\n  position: absolute;\n}\n\n.cell.selected-yellow::before {\n  border-color: #ff0;\n  border-style: solid;\n}\n\n.cell.selected-green::before {\n  border-color: #0f0;\n  border-style: dashed;\n}\n\n.cell.selected-red::before {\n  border-color: #f00;\n  border-style: dashed;\n}\n\n.board.prairie {\n  --map-tile-top-left-url: url(${tt});\n  --map-tile-top-url: url(${et});\n  --map-tile-top-right-url: url(${nt});\n  --map-tile-bottom-left-url: url(${rt});\n  --map-tile-bottom-url: url(${ot});\n  --map-tile-bottom-right-url: url(${it});\n  --map-tile-left-url: url(${at});\n  --map-tile-right-url: url(${ct});\n  --map-tile-center-url: url(${lt});\n}\n\n.board.desert {\n  --map-tile-top-left-url: url(${ut});\n  --map-tile-top-url: url(${st});\n  --map-tile-top-right-url: url(${ft});\n  --map-tile-bottom-left-url: url(${pt});\n  --map-tile-bottom-url: url(${ht});\n  --map-tile-bottom-right-url: url(${dt});\n  --map-tile-left-url: url(${yt});\n  --map-tile-right-url: url(${bt});\n  --map-tile-center-url: url(${mt});\n}\n\n.board.arctic {\n  --map-tile-top-left-url: url(${vt});\n  --map-tile-top-url: url(${gt});\n  --map-tile-top-right-url: url(${wt});\n  --map-tile-bottom-left-url: url(${St});\n  --map-tile-bottom-url: url(${kt});\n  --map-tile-bottom-right-url: url(${Pt});\n  --map-tile-left-url: url(${xt});\n  --map-tile-right-url: url(${Ot});\n  --map-tile-center-url: url(${jt});\n}\n\n.board.mountain {\n  --map-tile-top-left-url: url(${Lt});\n  --map-tile-top-url: url(${Et});\n  --map-tile-top-right-url: url(${Tt});\n  --map-tile-bottom-left-url: url(${Ct});\n  --map-tile-bottom-url: url(${Rt});\n  --map-tile-bottom-right-url: url(${_t});\n  --map-tile-left-url: url(${Ut});\n  --map-tile-right-url: url(${Gt});\n  --map-tile-center-url: url(${Mt});\n}\n\n.map-tile {\n  width: var(--cell-size);\n  height: var(--cell-size);\n}\n\n.map-tile-top-left {\n  background: var(--map-tile-top-left-url);\n}\n\n.map-tile-top {\n  background: var(--map-tile-top-url);\n}\n\n.map-tile-top-right {\n  background: var(--map-tile-top-right-url);\n}\n\n.map-tile-bottom-left {\n  background: var(--map-tile-bottom-left-url);\n}\n\n.map-tile-bottom {\n  background: var(--map-tile-bottom-url);\n}\n\n.map-tile-bottom-right {\n  background: var(--map-tile-bottom-right-url);\n}\n\n.map-tile-left {\n  background: var(--map-tile-left-url);\n}\n\n.map-tile-right {\n  background: var(--map-tile-right-url);\n}\n\n.map-tile-center {\n  background: var(--map-tile-center-url);\n}\n\n.character {\n  width: var(--cell-size);\n  height: var(--cell-size);\n  position: absolute;\n  z-index: 99;\n}\n\n.character.generic {\n  background: url(${$t});\n}\n\n.character.bowman {\n  background: url(${At});\n}\n\n.character.daemon {\n  background: url(${It});\n}\n\n.character.magician {\n  background: url(${zt});\n}\n\n.character.swordsman {\n  background: url(${Dt});\n}\n\n.character.undead {\n  background: url(${Nt});\n}\n\n.character.vampire {\n  background: url(${Bt});\n}\n\n.character.zombie {\n  background: url(${Ft});\n}\n\n.health-level {\n  top: 2px;\n  left: 7px;\n  position: absolute;\n  width: 50px;\n  height: 4px;\n  background: #000;\n}\n\n.health-level-indicator {\n  height: 4px;\n}\n\n.health-level-indicator-high {\n  background: #0f0;\n}\n\n.health-level-indicator-normal {\n  background: #ff0;\n}\n\n.health-level-indicator-critical {\n  background: #f00;\n}\n\n.damage {\n  position: absolute;\n  width: var(--cell-size);\n  text-align: center;\n  z-index: 999;\n  color: #f00;\n  font-weight: bold;\n  animation: 500ms fade ease-out;\n}\n\n@keyframes fade {\n  from {\n    opacity: 0;\n    top: calc(var(--cell-size) * 0.5);\n    font-size: 1rem;\n  }\n  to {\n    opacity: 1;\n    top: -20px;\n    font-size: 1.5rem;\n  }\n}\n`,""]);const qt=Z},1113(t){t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},1216(t,e,n){t.exports=n.p+"c75f062dddba6e98fdc6.png"},1265(t,e,n){t.exports=n.p+"26b5f224d8750119922d.png"},1409(t,e,n){t.exports=n.p+"946aeb948db6313f1d85.png"},1601(t){t.exports=function(t){return t[1]}},1605(t,e,n){t.exports=n.p+"246277b8ca590816b3e8.png"},1906(t,e,n){t.exports=n.p+"f462d2ed6eedca1e4fd9.png"},2076(t,e,n){t.exports=n.p+"cec542854b228e61547a.png"},2573(t,e,n){t.exports=n.p+"0089a610e6611f679b50.png"},3062(t,e,n){t.exports=n.p+"eb1f6e4f87b977012684.png"},3160(t,e,n){t.exports=n.p+"6f6f7c09bde970b2e41b.png"},3232(t,e,n){t.exports=n.p+"0ac7f8258ec7166dc957.png"},3860(t,e,n){t.exports=n.p+"cf170a9fea1051b7424a.png"},3933(t,e,n){t.exports=n.p+"8b928c3eb136543e573a.png"},4041(t,e,n){t.exports=n.p+"3d9503e0a850fda86f82.png"},4184(t,e,n){t.exports=n.p+"f1703771380a9959d979.png"},4347(t,e,n){t.exports=n.p+"6bacb8e25ed9ecf726bf.png"},4417(t){t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},4437(t,e,n){t.exports=n.p+"26fdc25019c24e87f11a.png"},4496(t,e,n){t.exports=n.p+"258d884122fabfc2f312.png"},4875(t,e,n){t.exports=n.p+"2c19971f327b288278bb.png"},5056(t,e,n){t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},5072(t){var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var i={},a=[],c=0;c<t.length;c++){var l=t[c],u=r.base?l[0]+r.base:l[0],s=i[u]||0,f="".concat(u," ").concat(s);i[u]=s+1;var p=n(f),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(h);else{var d=o(h,r);r.byIndex=c,e.splice(c,0,{identifier:f,updater:d,references:1})}a.push(f)}return a}function o(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,o){var i=r(t=t||[],o=o||{});return function(t){t=t||[];for(var a=0;a<i.length;a++){var c=n(i[a]);e[c].references--}for(var l=r(t,o),u=0;u<i.length;u++){var s=n(i[u]);0===e[s].references&&(e[s].updater(),e.splice(s,1))}i=l}}},5134(t,e,n){t.exports=n.p+"51e2a5de56bd631452fe.png"},5513(t,e,n){t.exports=n.p+"5cf9c17d6a1ea7106a6c.png"},5523(t,e,n){t.exports=n.p+"63aae58e4690953a3857.png"},6092(t,e,n){t.exports=n.p+"13edb269e39172ddd74f.png"},6153(t,e,n){t.exports=n.p+"e0aa3daf6d08c62c96d9.png"},6168(t,e,n){t.exports=n.p+"2007ec00c1d9f997e704.png"},6267(t,e,n){t.exports=n.p+"07d5e8127645225478b6.png"},6291(t,e,n){t.exports=n.p+"a1d2321024649b9d8f5f.png"},6314(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n}).join("")},e.i=function(t,n,r,o,i){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(r)for(var c=0;c<this.length;c++){var l=this[c][0];null!=l&&(a[l]=!0)}for(var u=0;u<t.length;u++){var s=[].concat(t[u]);r&&a[s[0]]||(void 0!==i&&(void 0===s[5]||(s[1]="@layer".concat(s[5].length>0?" ".concat(s[5]):""," {").concat(s[1],"}")),s[5]=i),n&&(s[2]?(s[1]="@media ".concat(s[2]," {").concat(s[1],"}"),s[2]=n):s[2]=n),o&&(s[4]?(s[1]="@supports (".concat(s[4],") {").concat(s[1],"}"),s[4]=o):s[4]="".concat(o)),e.push(s))}},e}},6318(t,e,n){t.exports=n.p+"ef1b0ea8c4e545d9aadc.png"},6943(t,e,n){t.exports=n.p+"c0fa2b75539f94144dc4.png"},7335(t,e,n){t.exports=n.p+"eab6a2cc5e89a4dd8e3f.png"},7538(t,e,n){t.exports=n.p+"22e7c5ede3f747cbe27a.png"},7659(t){var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},7825(t){t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},7935(t,e,n){t.exports=n.p+"46d63299c3420c030b4e.png"},7986(t,e,n){t.exports=n.p+"ac9d74f57639792774bc.png"},8341(t,e,n){t.exports=n.p+"0a77fc47d727eab6fd39.png"},8490(t,e,n){t.exports=n.p+"6a84ae91f5d985ddc9ee.png"},8956(t,e,n){t.exports=n.p+"dc3f97e7bbcd5ea1ded9.png"},9e3(t,e,n){t.exports=n.p+"d31d84c693f649766aee.png"},9221(t,e,n){t.exports=n.p+"2f1e1970c2c20cf3a8d5.png"},9334(t,e,n){t.exports=n.p+"296dfeac15e2377fc1dc.png"},9593(t,e,n){t.exports=n.p+"b27323cf850ed820855c.png"},9702(t,e,n){t.exports=n.p+"1d70f1dab2dd418c3612.png"},9745(t,e,n){t.exports=n.p+"546abb060a0837550fd1.png"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,exports:{}};return t[r](i,i.exports,n),i.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,n.nc=void 0;var r=n(5072),o=n.n(r),i=n(7825),a=n.n(i),c=n(7659),l=n.n(c),u=n(5056),s=n.n(u),f=n(540),p=n.n(f),h=n(1113),d=n.n(h),y=n(1016),b={};function m(t,e){var n=e-1,r=e*(e-1),o=e*e-1;return 0===t?"top-left":t===n?"top-right":t===r?"bottom-left":t===o?"bottom-right":t>0&&t<n?"top":t>r&&t<o?"bottom":t%e===0?"left":(t+1)%e===0?"right":"center"}function v(t){return t<15?"critical":t<50?"normal":"high"}function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function w(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=S(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function S(t,e){if(t){if("string"==typeof t)return k(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(t,e):void 0}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,x(r.key),r)}}function x(t){var e=function(t){if("object"!=g(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==g(e)?e:e+""}b.styleTagTransform=d(),b.setAttributes=s(),b.insert=l().bind(null,"head"),b.domAPI=a(),b.insertStyleElement=p(),o()(y.A,b),y.A&&y.A.locals&&y.A.locals;var O=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.boardSize=8,this.container=null,this.boardEl=null,this.cells=[],this.cellClickListeners=[],this.cellEnterListeners=[],this.cellLeaveListeners=[],this.newGameListeners=[],this.saveGameListeners=[],this.loadGameListeners=[]},e=[{key:"bindToDOM",value:function(t){if(!(t instanceof HTMLElement))throw new Error("container is not HTMLElement");this.container=t}},{key:"drawUi",value:function(t){var e=this;this.checkBinding(),this.container.innerHTML='\n      <div class="controls">\n        <button data-id="action-restart" class="btn">New Game</button>\n        <button data-id="action-save" class="btn">Save Game</button>\n        <button data-id="action-load" class="btn">Load Game</button>\n      </div>\n      <div class="board-container">\n        <div data-id="board" class="board"></div>\n      </div>\n    ',this.newGameEl=this.container.querySelector("[data-id=action-restart]"),this.saveGameEl=this.container.querySelector("[data-id=action-save]"),this.loadGameEl=this.container.querySelector("[data-id=action-load]"),this.newGameEl.addEventListener("click",function(t){return e.onNewGameClick(t)}),this.saveGameEl.addEventListener("click",function(t){return e.onSaveGameClick(t)}),this.loadGameEl.addEventListener("click",function(t){return e.onLoadGameClick(t)}),this.boardEl=this.container.querySelector("[data-id=board]"),this.boardEl.classList.add(t);for(var n=0;n<Math.pow(this.boardSize,2);n+=1){var r=document.createElement("div");r.classList.add("cell","map-tile","map-tile-".concat(m(n,this.boardSize))),r.addEventListener("mouseenter",function(t){return e.onCellEnter(t)}),r.addEventListener("mouseleave",function(t){return e.onCellLeave(t)}),r.addEventListener("click",function(t){return e.onCellClick(t)}),this.boardEl.appendChild(r)}this.cells=Array.from(this.boardEl.children)}},{key:"redrawPositions",value:function(t){var e,n=w(this.cells);try{for(n.s();!(e=n.n()).done;)e.value.innerHTML=""}catch(t){n.e(t)}finally{n.f()}var r,o=w(t);try{for(o.s();!(r=o.n()).done;){var i=r.value,a=this.boardEl.children[i.position],c=document.createElement("div");c.classList.add("character",i.character.type);var l=document.createElement("div");l.classList.add("health-level");var u=document.createElement("div");u.classList.add("health-level-indicator","health-level-indicator-".concat(v(i.character.health))),u.style.width="".concat(i.character.health,"%"),l.appendChild(u),c.appendChild(l),a.appendChild(c)}}catch(t){o.e(t)}finally{o.f()}}},{key:"addCellEnterListener",value:function(t){this.cellEnterListeners.push(t)}},{key:"addCellLeaveListener",value:function(t){this.cellLeaveListeners.push(t)}},{key:"addCellClickListener",value:function(t){this.cellClickListeners.push(t)}},{key:"addNewGameListener",value:function(t){this.newGameListeners.push(t)}},{key:"addSaveGameListener",value:function(t){this.saveGameListeners.push(t)}},{key:"addLoadGameListener",value:function(t){this.loadGameListeners.push(t)}},{key:"onCellEnter",value:function(t){t.preventDefault();var e=this.cells.indexOf(t.currentTarget);this.cellEnterListeners.forEach(function(t){return t.call(null,e)})}},{key:"onCellLeave",value:function(t){t.preventDefault();var e=this.cells.indexOf(t.currentTarget);this.cellLeaveListeners.forEach(function(t){return t.call(null,e)})}},{key:"onCellClick",value:function(t){var e=this.cells.indexOf(t.currentTarget);this.cellClickListeners.forEach(function(t){return t.call(null,e)})}},{key:"onNewGameClick",value:function(t){t.preventDefault(),this.newGameListeners.forEach(function(t){return t.call(null)})}},{key:"onSaveGameClick",value:function(t){t.preventDefault(),this.saveGameListeners.forEach(function(t){return t.call(null)})}},{key:"onLoadGameClick",value:function(t){t.preventDefault(),this.loadGameListeners.forEach(function(t){return t.call(null)})}},{key:"showError",value:function(t){alert(t)}},{key:"showMessage",value:function(t){alert(t)}},{key:"selectCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yellow";this.deselectCell(t),this.cells[t].classList.add("selected","selected-".concat(e))}},{key:"deselectCell",value:function(t){var e,n=this.cells[t];(e=n.classList).remove.apply(e,function(t){return function(t){if(Array.isArray(t))return k(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||S(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Array.from(n.classList).filter(function(t){return t.startsWith("selected")})))}},{key:"showCellTooltip",value:function(t,e){this.cells[e].title=t}},{key:"hideCellTooltip",value:function(t){this.cells[t].title=""}},{key:"showDamage",value:function(t,e){var n=this;return new Promise(function(r){var o=n.cells[t],i=document.createElement("span");i.textContent=e,i.classList.add("damage"),o.appendChild(i),i.addEventListener("animationend",function(){o.removeChild(i),r()})})}},{key:"setCursor",value:function(t){this.boardEl.style.cursor=t}},{key:"checkBinding",value:function(){if(null===this.container)throw new Error("GamePlay not bind to DOM")}}],e&&P(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();const j="prairie",L="desert",E="arctic",T="mountain";function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function R(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_(r.key),r)}}function _(t){var e=function(t){if("object"!=C(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==C(e)?e:e+""}var U=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.characters=[]},e=[{key:"add",value:function(t){this.characters.push(t)}},{key:"addAll",value:function(){var t;(t=this.characters).push.apply(t,arguments)}},{key:"toArray",value:function(){return this.characters}}],e&&R(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function G(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return M(u,"_invoke",function(n,r,o){var i,c,l,u=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,c=0,l=t,p.n=n,a}};function h(n,r){for(c=n,l=r,e=0;!f&&u&&!o&&e<s.length;e++){var o,i=s[e],h=p.p,d=i[2];n>3?(o=d===r)&&(l=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===s&&h(s,d),c=s,l=d;(e=c<2?t:l)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,l)):p.n=l:p.v=l);try{if(u=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?l:n.call(r,p))!==a)break}catch(e){i=t,c=1,l=e}finally{u=1}}return{value:e,done:f}}}(n,o,i),!0),u}var a={};function c(){}function l(){}function u(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(M(e={},r,function(){return this}),e),f=u.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,M(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return l.prototype=u,M(f,"constructor",u),M(u,"constructor",l),l.displayName="GeneratorFunction",M(u,o,"GeneratorFunction"),M(f),M(f,o,"Generator"),M(f,r,function(){return this}),M(f,"toString",function(){return"[object Generator]"}),(G=function(){return{w:i,m:p}})()}function M(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}M=function(t,e,n,r){function i(e,n){M(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},M(t,e,n,r)}var $=G().m(A);function A(t,e){var n,r,o;return G().w(function(i){for(;;)switch(i.n){case 0:return n=Math.floor(Math.random()*t.length),r=t[n],o=Math.floor(Math.random()*e)+1,i.n=1,new r(o);case 1:i.n=0;break;case 2:return i.a(2)}},$)}function I(t,e,n){for(var r=new U,o=A(t,e),i=0;i<n;i+=1)r.add(o.next().value);return r}function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,B(r.key),r)}}function N(t,e,n){return e&&D(t.prototype,e),n&&D(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function B(t){var e=function(t){if("object"!=z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==z(e)?e:e+""}var F=N(function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"generic";if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.level=e,this.attack=0,this.defence=0,this.health=50,this.type=n,(this instanceof t?this.constructor:void 0)===t)throw new Error("Cannot create an instance of Character directly class")});function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Q(r.key),r)}}function J(t,e,n){return e&&H(t.prototype,e),n&&H(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Q(t){var e=function(t){if("object"!=q(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==q(e)?e:e+""}var W=J(function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!(e instanceof F))throw new Error("character must be instance of Character or its children");if("number"!=typeof n)throw new Error("position must be a number");this.character=e,this.position=n});function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function V(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,X(r.key),r)}}function X(t){var e=function(t){if("object"!=K(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=K(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==K(e)?e:e+""}var Y=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.turn="player"},e=[{key:"from",value:function(t){return null}}],null&&V(t.prototype,null),e&&V(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();const Z="auto",tt="pointer",et="crosshair",nt="not-allowed";function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function ot(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ot=function(){return!!t})()}function it(t){return it=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},it(t)}function at(t,e){return at=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},at(t,e)}var ct=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,n){return e=it(e),function(t,e){if(e&&("object"==rt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ot()?Reflect.construct(e,n||[],it(t).constructor):e.apply(t,n))}(this,e,[t,"bowman"])).attack=25,n.defence=25,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&at(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(F);function lt(t){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(t)}function ut(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ut=function(){return!!t})()}function st(t){return st=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},st(t)}function ft(t,e){return ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ft(t,e)}var pt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,n){return e=st(e),function(t,e){if(e&&("object"==lt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ut()?Reflect.construct(e,n||[],st(t).constructor):e.apply(t,n))}(this,e,[t,"swordsman"])).attack=40,n.defence=10,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ft(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(F);function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function dt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(dt=function(){return!!t})()}function yt(t){return yt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yt(t)}function bt(t,e){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bt(t,e)}var mt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,n){return e=yt(e),function(t,e){if(e&&("object"==ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,dt()?Reflect.construct(e,n||[],yt(t).constructor):e.apply(t,n))}(this,e,[t,"magician"])).attack=10,n.defence=40,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bt(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(F);function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function gt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(gt=function(){return!!t})()}function wt(t){return wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wt(t)}function St(t,e){return St=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},St(t,e)}var kt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,n){return e=wt(e),function(t,e){if(e&&("object"==vt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,gt()?Reflect.construct(e,n||[],wt(t).constructor):e.apply(t,n))}(this,e,[t,"vampire"])).attack=25,n.defence=25,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&St(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(F);function Pt(t){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pt(t)}function xt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(xt=function(){return!!t})()}function Ot(t){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(t)}function jt(t,e){return jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jt(t,e)}var Lt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,n){return e=Ot(e),function(t,e){if(e&&("object"==Pt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,xt()?Reflect.construct(e,n||[],Ot(t).constructor):e.apply(t,n))}(this,e,[t,"undead"])).attack=40,n.defence=10,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jt(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(F);function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function Tt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Tt=function(){return!!t})()}function Ct(t){return Ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ct(t)}function Rt(t,e){return Rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Rt(t,e)}var _t=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,n){return e=Ct(e),function(t,e){if(e&&("object"==Et(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Tt()?Reflect.construct(e,n||[],Ct(t).constructor):e.apply(t,n))}(this,e,[t,"daemon"])).attack=10,n.defence=10,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rt(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(F);function Ut(t){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ut(t)}function Gt(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(Ut(t)+" is not iterable")}function Mt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return $t(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$t(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function $t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function At(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return It(u,"_invoke",function(n,r,o){var i,c,l,u=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,c=0,l=t,p.n=n,a}};function h(n,r){for(c=n,l=r,e=0;!f&&u&&!o&&e<s.length;e++){var o,i=s[e],h=p.p,d=i[2];n>3?(o=d===r)&&(l=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=n<2&&h<i[1])?(c=0,p.v=r,p.n=i[1]):h<d&&(o=n<3||i[0]>r||r>d)&&(i[4]=n,i[5]=r,p.n=d,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===s&&h(s,d),c=s,l=d;(e=c<2?t:l)||!f;){i||(c?c<3?(c>1&&(p.n=-1),h(c,l)):p.n=l:p.v=l);try{if(u=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,l)))throw TypeError("iterator result is not an object");if(!e.done)return e;l=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?l:n.call(r,p))!==a)break}catch(e){i=t,c=1,l=e}finally{u=1}}return{value:e,done:f}}}(n,o,i),!0),u}var a={};function c(){}function l(){}function u(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(It(e={},r,function(){return this}),e),f=u.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,u):(t.__proto__=u,It(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return l.prototype=u,It(f,"constructor",u),It(u,"constructor",l),l.displayName="GeneratorFunction",It(u,o,"GeneratorFunction"),It(f),It(f,o,"Generator"),It(f,r,function(){return this}),It(f,"toString",function(){return"[object Generator]"}),(At=function(){return{w:i,m:p}})()}function It(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}It=function(t,e,n,r){function i(e,n){It(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},It(t,e,n,r)}function zt(t,e,n,r,o,i,a){try{var c=t[i](a),l=c.value}catch(t){return void n(t)}c.done?e(l):Promise.resolve(l).then(r,o)}function Dt(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(t){zt(i,r,o,a,c,"next",t)}function c(t){zt(i,r,o,a,c,"throw",t)}a(void 0)})}}function Nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Bt(r.key),r)}}function Bt(t){var e=function(t){if("object"!=Ut(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ut(e)?e:e+""}var Ft=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gamePlay=e,this.stateService=n,this.gameState=new Y,this.selectedIndex=null,this.level=1,this.score=0,this.themes=[j,L,E,T]},e=[{key:"init",value:function(){this.newGame(),this.gamePlay.addCellEnterListener(this.onCellEnter.bind(this)),this.gamePlay.addCellLeaveListener(this.onCellLeave.bind(this)),this.gamePlay.addCellClickListener(this.onCellClick.bind(this)),this.gamePlay.addNewGameListener(this.newGame.bind(this)),this.gamePlay.addSaveGameListener(this.onSaveGameClick.bind(this)),this.gamePlay.addLoadGameListener(this.onLoadGameClick.bind(this))}},{key:"newGame",value:function(){this.level=1,this.score=0,this.gameState.turn="player",this.selectedIndex=null;var t=[ct,pt,mt],e=[kt,Lt,_t];this.playerTeam=I(t,1,2),this.enemyTeam=I(e,1,2),this.initLevel()}},{key:"initLevel",value:function(){this.gameState.turn="player",this.selectedIndex=null;var t=this.themes[(this.level-1)%4];this.gamePlay.drawUi(t);var e=[],n=this.getStartPosition(this.playerTeam.characters.length,"player");this.playerTeam.characters.forEach(function(t,r){e.push(new W(t,n[r]))});var r=this.getStartPosition(this.enemyTeam.characters.length,"enemy");this.enemyTeam.characters.forEach(function(t,n){e.push(new W(t,r[n]))}),this.positions=e,this.gamePlay.redrawPositions(e)}},{key:"levelUp",value:function(){var t=this;this.level+=1,this.playerTeam.characters.forEach(function(t){t.level+=1,t.attack=Math.max(t.attack,t.attack*(80+t.health)/100),t.defence=Math.max(t.defence,t.defence*(80+t.health)/100),t.health=Math.min(t.health+80,100)}),I([ct,pt,mt],this.level-1||1,1).characters.forEach(function(e){t.playerTeam.characters.push(e)});var e=[kt,Lt,_t];this.enemyTeam=I(e,this.level+1,this.playerTeam.characters.length+1),this.initLevel()}},{key:"attack",value:(r=Dt(At().m(function t(e,n,r){var o;return At().w(function(t){for(;;)switch(t.n){case 0:return o=Math.max(n.character.attack-r.character.defence,.1*n.character.attack),t.n=1,this.gamePlay.showDamage(e,o);case 1:if(r.character.health-=o,!(r.character.health<=0)){t.n=3;break}if(this.positions=this.positions.filter(function(t){return t.position!==e}),["bowman","swordsman","magician"].includes(r.character.type)?this.playerTeam.characters=this.playerTeam.characters.filter(function(t){return t!==r.character}):this.enemyTeam.characters=this.enemyTeam.characters.filter(function(t){return t!==r.character}),0!==this.enemyTeam.characters.length){t.n=2;break}return this.levelUp(),t.a(2);case 2:if(0!==this.playerTeam.characters.length){t.n=3;break}return this.gamePlay.showMessage("Game Over!"),t.a(2);case 3:this.gamePlay.redrawPositions(this.positions),"player"===this.gameState.turn?(this.gameState.turn="computer",this.gamePlay.deselectCell(this.selectedIndex),this.selectedIndex=null,this.enemyAction()):this.gameState.turn="player";case 4:return t.a(2)}},t,this)})),function(t,e,n){return r.apply(this,arguments)})},{key:"enemyAction",value:(n=Dt(At().m(function t(){var e,n,r,o,i,a,c,l,u,s,f,p,h,d,y,b,m,v,g,w,S=this;return At().w(function(t){for(;;)switch(t.p=t.n){case 0:if("computer"===this.gameState.turn){t.n=1;break}return t.a(2);case 1:if(e=this.positions.filter(function(t){return["vampire","undead","daemon"].includes(t.character.type)}),n=this.positions.filter(function(t){return["bowman","swordsman","magician"].includes(t.character.type)}),0!==e.length&&0!==n.length){t.n=2;break}return t.a(2);case 2:r=Mt(e),t.p=3,i=At().m(function t(){var e,r;return At().w(function(t){for(;;)switch(t.n){case 0:if(e=o.value,r=n.find(function(t){return S.canAttack(e,t.position)}),!r){t.n=2;break}return t.n=1,S.attack(r.position,e,r);case 1:return t.a(2,{v:void 0});case 2:return t.a(2)}},t)}),r.s();case 4:if((o=r.n()).done){t.n=7;break}return t.d(Gt(i()),5);case 5:if(!(a=t.v)){t.n=6;break}return t.a(2,a.v);case 6:t.n=4;break;case 7:t.n=9;break;case 8:t.p=8,w=t.v,r.e(w);case 9:return t.p=9,r.f(),t.f(9);case 10:c=Math.floor(Math.random()*e.length),l=e[c],u=null,s=1/0,f=Mt(n);try{for(f.s();!(p=f.n()).done;)h=p.value,(d=Math.abs(l.position-h.position))<s&&(s=d,u=h)}catch(t){f.e(t)}finally{f.f()}if(!u){t.n=14;break}y=this.indexToCoords(u.position),b=null,m=1/0,v=At().m(function t(e){var n,r;return At().w(function(t){for(;;)switch(t.n){case 0:!S.positions.some(function(t){return t.position===e})&&S.canMove(l,e)&&(n=S.indexToCoords(e),(r=Math.abs(n.row-y.row)+Math.abs(n.col-y.col))<m&&(m=r,b=e));case 1:return t.a(2)}},t)}),g=0;case 11:if(!(g<Math.pow(this.gamePlay.boardSize,2))){t.n=13;break}return t.d(Gt(v(g)),12);case 12:g++,t.n=11;break;case 13:null!==b&&(l.position=b,this.gamePlay.redrawPositions(this.positions),this.gameState.turn="player");case 14:return t.a(2)}},t,this,[[3,8,9,10]])})),function(){return n.apply(this,arguments)})},{key:"getStartPosition",value:function(t,e){for(var n=this.gamePlay.boardSize,r=[],o=0;o<n*n;o++){var i=o%n;"player"===e?0!==i&&1!==i||r.push(o):i!==n-2&&i!==n-1||r.push(o)}for(var a=[],c=0;c<t;c++){var l=Math.floor(Math.random()*r.length);a.push(r[l]),r.splice(l,1)}return a}},{key:"onCellClick",value:function(t){var e=this;if("computer"!==this.gameState.turn){var n=this.positions.find(function(e){return e.position===t});if(n){if(["bowman","swordsman","magician"].includes(n.character.type))null!==this.selectedIndex&&this.gamePlay.deselectCell(this.selectedIndex),this.gamePlay.selectCell(t),this.selectedIndex=t;else if(null!==this.selectedIndex){var r=this.positions.find(function(t){return t.position===e.selectedIndex});this.canAttack(r,t)?this.attack(t,r,n):this.gamePlay.showError("Ð¡Ð»Ð¸ÑˆÐºÐ¾Ð¼ Ð´Ð°Ð»ÐµÐºÐ¾ Ð´Ð»Ñ Ð°Ñ‚Ð°ÐºÐ¸!")}}else if(null!==this.selectedIndex){var o=this.positions.find(function(t){return t.position===e.selectedIndex});this.canMove(o,t)&&(this.gamePlay.deselectCell(this.selectedIndex),o.position=t,this.gamePlay.redrawPositions(this.positions),this.selectedIndex=null,this.gameState.turn="computer",this.enemyAction())}}}},{key:"onCellEnter",value:function(t){var e,n=this,r=this.positions.find(function(e){return e.position===t});if(r){var o=(e=r.character,"ðŸŽ–".concat(e.level," âš”").concat(e.attack," ðŸ›¡").concat(e.defence," â¤").concat(e.health));this.gamePlay.showCellTooltip(o,t)}if(null!==this.selectedIndex){var i=this.positions.find(function(t){return t.position===n.selectedIndex});if(t===this.selectedIndex)return;r?["bowman","swordsman","magician"].includes(r.character.type)?this.gamePlay.setCursor(tt):this.canAttack(i,t)?(this.gamePlay.setCursor(et),this.gamePlay.selectCell(t,"red")):this.gamePlay.setCursor(nt):this.canMove(i,t)?(this.gamePlay.setCursor(tt),this.gamePlay.selectCell(t,"green")):this.gamePlay.setCursor(nt)}}},{key:"onCellLeave",value:function(t){this.gamePlay.hideCellTooltip(t),this.gamePlay.setCursor(Z),this.selectedIndex!==t&&this.gamePlay.deselectCell(t)}},{key:"canMove",value:function(t,e){var n=this.getRange(t.character.type,"move"),r=this.indexToCoords(t.position),o=r.row,i=r.col,a=this.indexToCoords(e),c=a.row,l=a.col,u=Math.abs(o-c),s=Math.abs(i-l);return!(0!==u&&0!==s&&u!==s)&&Math.max(u,s)<=n}},{key:"canAttack",value:function(t,e){var n=this.getRange(t.character.type,"attack"),r=this.indexToCoords(t.position),o=r.row,i=r.col,a=this.indexToCoords(e),c=a.row,l=a.col,u=Math.abs(o-c),s=Math.abs(i-l);return Math.max(u,s)<=n}},{key:"getRange",value:function(t,e){return{swordsman:{move:4,attack:1},undead:{move:4,attack:1},bowman:{move:2,attack:2},vampire:{move:2,attack:2},magician:{move:1,attack:4},daemon:{move:1,attack:4}}[t][e]}},{key:"onSaveGameClick",value:function(){var t={level:this.level,turn:this.gameState.turn,score:this.score,playerTeam:this.playerTeam,enemyTeam:this.enemyTeam,positions:this.positions};this.stateService.save(t),this.gamePlay.showMessage("Ð˜Ð³Ñ€Ð° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð°!")}},{key:"onLoadGameClick",value:function(){try{var t=this.stateService.load();if(!t)return;this.level=t.level,this.score=t.score,this.gameState.turn=t.turn,this.playerTeam=t.playerTeam,this.enemyTeam=t.enemyTeam,this.positions=t.positions;var e=this.themes[(this.level-1)%4];this.gamePlay.drawUi(e),this.gamePlay.redrawPositions(this.positions),this.gamePlay.showMessage("Ð˜Ð³Ñ€Ð° Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð°!")}catch(t){this.gamePlay.showError("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¸Ð³Ñ€Ñƒ")}}},{key:"indexToCoords",value:function(t){var e=this.gamePlay.boardSize;return{row:Math.floor(t/e),col:t%e}}}],e&&Nt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function qt(t){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(t)}function Ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Jt(r.key),r)}}function Jt(t){var e=function(t){if("object"!=qt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qt(e)?e:e+""}var Qt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage=e},(e=[{key:"save",value:function(t){this.storage.setItem("state",JSON.stringify(t))}},{key:"load",value:function(){try{return JSON.parse(this.storage.getItem("state"))}catch(t){throw new Error("Invalid state")}}}])&&Ht(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),Wt=new O;Wt.bindToDOM(document.querySelector("#game-container")),new Ft(Wt,new Qt(localStorage)).init()})();